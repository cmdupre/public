(()=>{"use strict";const e={todoForProjectId:e=>e&&"allprojects"!==e?t=>t.getProjectId()===e:()=>!0,displayDate:e=>`${e.getUTCMonth()+1}/${e.getUTCDate()}/${e.getUTCFullYear()}`};const t={show:function(e){const t=document.createElement("input");t.id="description",t.name="description",t.type="text",t.placeholder="Description...",t.autocomplete="off";const o=document.createElement("button");o.type="submit",o.textContent="Submit";const d=document.createElement("form");d.addEventListener("submit",e),d.appendChild(t),d.appendChild(o),document.getElementById("add-project-button").before(d),t.focus()}};const o={show:function(e){const t=document.createElement("input");t.id="description",t.name="description",t.type="text",t.placeholder="Description...",t.autocomplete="off";const o=document.createElement("input");o.id="priority",o.name="priority",o.type="text",o.placeholder="Priority...";const d=document.createElement("input");d.id="due",d.name="due",d.type="date",d.placeholder="Due Date...";const n=document.createElement("button");n.type="submit",n.textContent="Submit";const c=document.createElement("form");c.addEventListener("submit",e),c.appendChild(t),c.appendChild(o),c.appendChild(d),c.appendChild(n),document.querySelector(".todo-buttons").before(c),t.focus()}};let d=0;function n(e){const t=e.id,o=new Date(e.created);let n=e.desc;const c=Number(e.id.slice(7));return c>=d&&(d=c+1),{getId:()=>t,getCreated:()=>o,getDescription:()=>n,toObject:function(){return{id:t,created:o,desc:n}}}}const c={create:function(e){return n({id:"project"+d++,created:new Date,desc:e})},createFromObject:n};let r=0;function s(e){const t=e.pid,o=e.id,d=new Date(e.created);let n=e.desc,c=e.pri,s=new Date(e.dd),l=e.completed;const i=Number(e.id.slice(4));return i>=r&&(r=i+1),{getProjectId:()=>t,getId:()=>o,getCreated:()=>d,getDescription:()=>n,getPriority:()=>c,getDue:()=>s,getCompleted:()=>l,toggleCompleted:()=>l=!l,toObject:function(){return{pid:t,id:o,created:d,desc:n,pri:c,dd:s,completed:l}}}}const l={create:function(e,t,o=new Date,d="100"){return s({pid:e,id:"todo"+r++,created:new Date,desc:t,pri:d,dd:o,completed:!1})},createFromObject:s},i="projects",a="todos";function p(e,t,o=localStorage){const d=[];for(const e of t)d.push(e.toObject());o.setItem(e,JSON.stringify(d))}function u(e,t=localStorage){return JSON.parse(t.getItem(e)||"[]")}const m=(e,t)=>p(i,e,t),g=(e,t)=>p(a,e,t),C=e=>{const t=u(i,e),o=[];for(const e of t)o.push(c.createFromObject(e));return o},f=e=>{const t=u(a,e),o=[];for(const e of t)o.push(l.createFromObject(e));return o};let h=C(),j=f(),E="allprojects";const b={getProjects:()=>h,getTodos:()=>j,getTodosForSelectedId:()=>j.filter(e.todoForProjectId(E)),getSelectedProjectId:()=>E,setSelectedProjectId:e=>E=e,addProject(e){const t=c.create(e);h.push(t),E=t.getId(),m(h)},toggleCompleted(e){const t=j.filter((t=>t.getId()===e));1===t.length&&(t[0].toggleCompleted(),g(j))},addTodo(e,t,o){const d=l.create(E,e,t,o);j.push(d),g(j)},sweepCompleted(){const e=[];for(const t of j)"allprojects"===E||t.getProjectId()===E?!1===t.getCompleted()&&e.push(t):e.push(t);j=e;const t=j.map((e=>e.getProjectId())),o=[];for(const e of h)t.includes(e.getId())&&o.push(e);h=o,m(h),g(j),E="allprojects"}},I=document.querySelector(".projects"),y=document.querySelector(".todos");function D(){!function(){const e=document.createElement("ul");if(e.classList.add("projects-list"),b.getProjects().length>0){let t=document.createElement("li");t.classList.add("project"),t.classList.add("all"),t.id="allprojects",t.textContent="All Projects",t.addEventListener("click",P),e.appendChild(t)}for(let t of b.getProjects()){let o=document.createElement("li");o.classList.add("project"),o.id=t.getId(),o.textContent=t.getDescription(),o.addEventListener("click",P),e.appendChild(o)}const t=document.createElement("button");t.textContent="Add Project",t.id="add-project-button",t.addEventListener("click",L),e.appendChild(t),I.hasChildNodes()?I.replaceChild(e,I.firstChild):I.appendChild(e),b.getProjects().length>0&&document.getElementById(b.getSelectedProjectId()).classList.add("selected")}(),function(){const t=document.createElement("ul");t.classList.add("todos-list");for(let o of b.getTodosForSelectedId()){const d=document.createElement("li");d.classList.add("todo"),d.id=o.getId(),t.appendChild(d);const n=document.createElement("p");n.classList.add("description"),n.textContent=o.getDescription(),d.appendChild(n);const c=document.createElement("p");c.classList.add("priority"),c.textContent=`Priority: ${o.getPriority()}`,d.appendChild(c);const r=document.createElement("date");r.classList.add("due-date"),r.textContent=`Due date: ${e.displayDate(o.getDue())}`,d.appendChild(r);const s=document.createElement("label");s.classList.add("completed"),s.textContent="Completed:",d.appendChild(s);const l=document.createElement("input");l.type="checkbox",l.id=`completed-${o.getId()}`,l.name="completed",l.classList.add("completed"),l.textContent="Completed:",l.checked=o.getCompleted(),l.addEventListener("click",S),s.appendChild(l)}const o=document.createElement("li");o.classList.add("todo-buttons"),t.appendChild(o);const d=document.createElement("button");d.textContent="Add Todo",d.id="add-todo-button",d.addEventListener("click",x),o.appendChild(d);const n=document.createElement("button");n.textContent="Sweep",n.id="sweep-button",n.addEventListener("click",B),o.appendChild(n),y.hasChildNodes()?y.replaceChild(t,y.firstChild):y.appendChild(t)}()}function P(e){b.setSelectedProjectId(e.target.id),D()}function L(){F(),t.show(w)}function w(e){e.preventDefault();const t=document.getElementById("description").value;""!==t.trim()&&(b.addProject(t),D())}function S(e){const t=e.target.id.split("-")[1];b.toggleCompleted(t)}function x(){F(),o.show(v)}function v(e){e.preventDefault();const t=document.getElementById("description").value,o=document.getElementById("priority").value,d=""===o.trim()?"100":o,n=document.getElementById("due").value,c=""===n.trim()?new Date:new Date(n);""!==t.trim()&&(b.addTodo(t,c,d),D())}function B(){F(),b.sweepCompleted(),b.setSelectedProjectId("allprojects"),D()}function F(){document.getElementById("add-project-button").disabled=!0,document.getElementById("add-todo-button").disabled=!0,document.getElementById("sweep-button").disabled=!0}({renderContent:D}).renderContent()})();